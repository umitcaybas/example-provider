language: node_js
node_js:
  - 10
services:
  - docker
env:
  global:
    - PACT_BROKER_BASE_URL=https://ucaybas.pactflow.io
    - PACT_BROKER_PUBLISH_VERIFICATION_RESULTS=true
    # Encrypted PACT_BROKER_TOKEN
    - secure: "uSZIucZhL0q3/7eCo+7ZaBcFHVcaryFiIQmcxAifmKlBPQLhzxu4GB+d347hHOSONTS9MU7bOV9Sqc9B8gea6MttYCJnsbQWO263rmfk35oNtxgLP4iEhw31FBYy4Dkx5vV2JG7uy7AlgsGwRmPeG3H4sePPc/H1yDfTNIubV3qQEBXh4Mou6CiwTzshidGRckUazqnYzZx64cqVtOf8WiDIDknm2nG64vwtqLBhDSE7usXBYcafZs9hdGVRPZhQ+R+VxWR8+366dNUbmdn62uKFbjxzk6YxkQI0d434p1l9vy/BbtgerNT1VVSAtV09d2R8w6c4mNPMjtb4kL3/HupElQrI24jkblWj1m/E9RTzx3c9pGMmI+Cxzk0mXXHavWOPdHVHaaEVqKqztcmW8wHv4schJh6m7sAzwyQlThs9MB/hb9BTKMNdNmDzFCtO3HKgU9JDJDbYhMH8IMbq9g+yqZsUKzJL6WvLlm9JErlz5gr7FPc1FdjIiuRW6fj+slw2EJZQTx7Fqw0xrYV0mKN6sOY4pPFt81KOvhNl4ahMamgYf/NwJILkBjCEWinKYN6CyxkL0Y90q96AdmyE80VgYc5BDEMGtXCJHwvLhnUwQcm+CaC7D6Jp7G4jsciekflPdQ5YHinUL+/uH00Hk56W+1YqCQbyL8Y2f7X4AQA="
before_script:
  - docker pull pactfoundation/pact-cli:latest
script:
  # When a webhook triggers a build, the PACT_URL will be set. In this case, just run the verification step.
  # Otherwise, run the normal build.
  # This is just to get around the fact that Travis CI only has one build definition per repository.
  # Normally you would define a separate job for the webhook triggered verification.
  - >
    if [ -n "${PACT_URL}" ]; then
      make ci_webhook
    else
      make ci
    fi
